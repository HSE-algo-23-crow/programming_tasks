# Алгоритм Бойера-Мура-Хорспула

## Описание алгоритма

Алгоритм Бойера-Мура-Хорспула  является оптимизированным вариантом алгоритма Бойера-Мура для поиска подстрок в строке. Основная идея алгоритма заключается в использовании эвристики плохого символа для пропуска ненужных сравнений, что делает его эффективным на практике.

1.  **Предварительная обработка:**
    
    -   Создается *таблица смещений*  для всех символов алфавита. В этой таблице хранится информация о том, на сколько символов можно сместить шаблон при несоответствии символа.
    -    Для каждого символа в шаблоне, кроме последнего, записывается, сколько символов нужно пропустить, если произойдет несоответствие. Это количество вычисляется следующим образом: *из длины шаблона вычитается номер символа и еще 1*.  Данный подсчет идет справа налево, начиная с предпоследнего символа. 
    -  Если символ повторяется, используется смещение для последнего вхождения символа в шаблон (считая слева направо, но исключая последний символ).
    -   Для последнего символа шаблона смещение равно длине всего шаблона.
    -   Если символ отсутствует в шаблоне, ему присваивается смещение, равное длине шаблона.
2.  **Поиск:**
    
    -   Шаблон накладывается на начало текста.
    -   Сравнение символов начинается с конца шаблона.
    -   Если символы совпадают, продолжается сравнение следующих символов справа налево.
    -   Если обнаружено несовпадение, шаблон смещается вправо на величину, указанную в таблице смещений для символа текста, который не совпал с соответствующим символом шаблона.
    -   Процесс продолжается до тех пор, пока шаблон не выйдет за пределы текста.

### Входные данные:

1.  **Текст (text)** - строка, в которой выполняется поиск. Это может быть любой текст (последовательность символов), например, абзац из книги, строка символов или последовательность ДНК.
2.  **Шаблон (pattern)** - строка, которую нужно найти в тексте. Это может быть слово или последовательность символов, которую ищем.

### Выходные данные:

-   **Позиция первого вхождения шаблона в тексте (индексация с нуля):** Если шаблон найден в тексте, возвращается индекс первого символа этого вхождения.
-   **-1:** Если шаблон не найден в тексте, возвращается -1.

### Области допустимых значений:

-   **Текст (text):**
    
    -   Может содержать любые символы, включая пробелы, знаки препинания и специальные символы.
    -   Длина текста должна быть больше или равна длине шаблона.
-   **Шаблон (pattern):**
    
    -   Может содержать любые символы, включая пробелы, знаки препинания и специальные символы.
    -   Длина шаблона должна быть меньше или равна длине текста.
    -   Длина шаблона должна быть больше нуля (нельзя искать пустую строку).

## Пример выполнения алгоритма

Дан текст и шаблон. Требуется найти первое вхождение шаблона в тексте. Если шаблон присутствует в тексте, необходимо вернуть индекс начала первого вхождения шаблона. Если шаблон не найден, вернуть -1.

**Входные данные:**

-   **Текст:** "abeccacbadbabbad"
-   **Шаблон:** "abbad"  
  #
  
  **1. Предварительная обработка, построение таблицы смещений.**
  -  Для символа 'a' (предпоследний символ шаблона abb**a**d): смещение = 5 - 3 - 1 = 1
  -  Для символа 'b' (третий символ шаблона ab**b**ad): смещение  = 5 - 2 - 1 = 2
  -  Для символа 'b' (второй символ шаблона a**b**bad): смещение для последнего вхождения b  = 2
  -  Для символа 'a' (первый символ шаблона **a**bbad): повторяющийся символ, равен последнему вхождению = 1
  - Для символа 'd' (пятый символ шаблона abba**d**): смещение = 5 (последний символ шаблона)
  - Для всех остальных символов смещение = 5 (длина шаблона)

Таблица смещений:

| Символ         |  a | b  | b  | a  |  d |  все остальные |
|:---------------|:--:|:--:|:--:|:--:|:--:|:--------------:|
| Смещение       |  1 | 2  | 2  | 1  |  5 |        5       |

#

**2. Поиск.**

Накладываем шаблон на начало строки.

|  a | b  | e  | c  |  c |  a |  c |  b |  a |  d |  b |  a |  b |  b |  a |  d |
|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|
|  a | b  | b  | a  |  d |    |    |    |    |    |    |    |    |    |    |    |

Последний символ исходной строки «с» не содержится в шаблоне. Сдвигаем образец вправо на 5 позиций в соответствии со значением смещения для «с»:

|  a | b  | e  | c  |  c |  a |  c |  b |  a |  d |  b |  a |  b |  b |  a |  d |
|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|
|    |    |    |    |    |  a | b  | b  | a  |  d |    |    |    |    |    |    |

Три символа образца совпали, а четвёртый — нет. Сдвигаем образец вправо на 5 позиций в соответствии со значением смещения для «d»:

|  a | b  | e  | c  |  c |  a |  c |  b |  a |  d |  b |  a |  b |  b |  a |  d |
|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|
|    |    |    |    |    |    |    |    |    |    |  a | b  | b  | a  |  d |    |

Последний символ строки «a» не совпадает с символом шаблона. Сдвигаем образец вправо на 1 в соответствии со значением смещения для «a» и получаем искомое вхождение образца:

|  a | b  | e  | c  |  c |  a |  c |  b |  a |  d |  b |  a |  b |  b |  a |  d |
|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|
|    |    |    |    |    |    |    |    |    |    |    |  a | b  | b  | a  |   d|

Алгоритм завершил работу. Подстрока (шаблон) из условия был найден в текст. Индекс начала первого вхождения шаблона = 11.
